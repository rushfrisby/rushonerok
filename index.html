<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>Rush Frisby</title>
<meta name="HandheldFriendly" content="True" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/css/screen.css" />
<link rel="stylesheet" type="text/css" href="/css/webkid.css" />
<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
<meta property="og:site_name" content="Rush Frisby" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Rush Frisby" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Rush Frisby" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Rush Frisby" />
<!--<link rel="alternate" type="application/rss+xml" title="Rush Frisby's Blog" href="https://rushfrisby.com/rss/" />-->
</head>
<body class="post-template">
<link rel="stylesheet" href="/css/prism.css">
<script src="/js/prism.js" type="text/javascript"></script>
<header id="header">
<nav class="header-nav" ">
<div class="blog-title"><a href="/">Rush Frisby</a></div>
<div class="blog-description">Thoughts on software and technology.</div>

<div class="taglist-wrapper clearfix">
<ul id="taglist" class="taglist">
<li class="nav-home" role="presentation">
<a href="/">Home</a>
</li>
<li class="nav-about" role="presentation">
<a href="/about">About</a>
</li>
<li class="nav-mechanical-keyboards" role="presentation">
<a href="/mechanical-keyboards">Mechanical Keyboards</a>
</li>
<li class="nav-about" role="presentation">
<a href="/tags">Tags</a>
</li>
<li class="nav-about" role="presentation">
<a href="/archive">Archive</a>
</li>
</ul>
</div>
</nav>
</header>
<main id="content" class="content" role="main">
<div id="article" class="box ">
<article class='post'>
<header class='post-header'>
<a href='/interface-to-rpc-service'><h1 class='post-title'>Interface to RPC Service</h1></a>
<section class='post-meta'>
<time class='post-date' datetime='2018-08-02'>Thursday, August 2, 2018</time>
</section>
</header>
<section class='post-content'>
<p>I'm currently working on <a href="https://github.com/rushfrisby/InterfaceRpc">a project to quickly stand up an RPC service</a> based on an interface. It's a .NET Standard library. Here's how it works.</p>

<p>Let's say you have an interface,  </p>

<pre><code>public interface IEchoService  
{
    string Echo(string echo);
}
</code></pre>

<p>, and you have an implementation that needs to be exposed so that others can call it. I chose HTTP for this.</p>

<p>On the server I use <code>HttpListener</code> to create a web server and listen for requests. When a request comes in the path maps to a method name. For example, if my web server is listening on <code>http://localhost:6000/</code> and a request for <code>http://localhost:6000/Echo</code> comes in - that maps to the <code>Echo</code> method on the interface... then I use reflection to call it on the implementation that was provided.</p>

<p>If <code>Echo</code> didn't map to a method on the interface then a 404 response is returned.</p>

<p>In my library all HTTP requests are POSTs. The content is deserialized based upon the <code>Content-Type</code> header value of the request. I am using another library I created to handle this called <a href="https://github.com/rushfrisby/SerializerDotNet">SerializerDotNet</a>. At the time of writing it supports JSON and Protobuf. The same serializer used for deserialization is also used to return data in the response and the response's <code>Content-Type</code> is the same as the incoming request.</p>

<p>Remember when I said "quickly stand up an RPC service"? This is how quickly it's done...  </p>

<pre><code>var svc = new RpcService&lt;IEchoService&gt;(new EchoService());  
svc.Start();  
</code></pre>

<p>To use this in your own project add <a href="https://www.nuget.org/packages/InterfaceRpc.Service/">InterfaceRpc.Service</a> to your project using NuGet.</p>

<p>There is a file called <code>rpcsettings.json</code> where you can specify additional settings. Currently only the web server prefixes and number of connections.</p>

<p>To create a client it's just as easy...  </p>

<pre><code>var client = new RpcClient&lt;IEchoService&gt;.Create("http://localhost:6000/");  
</code></pre>

<p>To use this in your own project add <a href="https://www.nuget.org/packages/InterfaceRpc.Client/">InterfaceRpc.Client</a> to your project using NuGet.</p>

<p>By default it uses <code>JsonSerializer</code>. There is an optional 2nd argument where you can specify the type of <code>ISerializer</code> (like <code>ProtobufSerializer</code>)</p>

<p>Then you can call any method defined in your interface:</p>

<pre><code>var echoed = client.Echo("hello");  
</code></pre>

<h4 id="limitations">Limitations</h4>

<p>(stuff I could use help on)</p>

<ul>
<li><p>I punted on handling SSL certs so it only runs over plain HTTP right now. This seems reasonable given that it's common to setup a load balancer or proxy in front of web sites and services.</p></li>
<li><p>8 parameters in method signatures - this can expand to more in the future, if needed, but I think once you get this many it's better to create a class with properties for each and use 1 parameter in the signature.</p></li>
<li><p>Because of limitations with <code>ValueTuple</code>, text based serialization reads a little funky, but I'm sure Microsoft will fix this in future versions of .NET Standard. In the meantime I'm curious to see what people think about having "Item1", "Item2", etc... map to method parameters. There could be some work done to replace these with parameter names but it would add (unnecessary?) overhead.</p></li>
<li><p>A good name. Any suggestions?</p></li>
<li><p>See the <a href="https://github.com/rushfrisby/InterfaceRpc/issues">issues list on github</a> for more</p></li>
</ul>

<h4 id="why">Why?</h4>

<p>This will help tremendously in moving off of WCF / .NET Framework and onto .NET Core. WCF clients aren't supported in .NET Core. The good thing about WCF is that it is interface-based, so swapping out a server implementation is relatively easy. Assuming a <code>ChannelFactory</code> was used for the client, it can be replaced even easier.</p>

<p>If you'd like to help in fleshing this idea out more please contribute through the <a href="https://github.com/rushfrisby/InterfaceRpc">github repo</a>!</p>

<table width="100%" style="border:1px solid #c0c0c0;">  
<tr>  
<td nowrap="nowrap"><a href="https://www.nuget.org/packages/InterfaceRpc.Service/" target="_blank">InterfaceRpc.Service</a></td>  
<td width="100%"><a href="https://www.nuget.org/packages/InterfaceRpc.Service/" target="_blank"><img src="https://img.shields.io/nuget/v/InterfaceRpc.Service.svg?style=flat" alt="NuGet Status" style="display:inline;padding:0" /></a></td>  
</tr>  
<tr>  
<td nowrap="nowrap"><a href="https://www.nuget.org/packages/InterfaceRpc.Client/" target="_blank">InterfaceRpc.Client</a></td>  
<td width="100%"><a href="https://www.nuget.org/packages/InterfaceRpc.Client/" target="_blank"><img src="https://img.shields.io/nuget/v/InterfaceRpc.Client.svg?style=flat" alt="NuGet Status" style="display:inline;padding:0" /></a></td>  
</tr>  
</table>
</section>
<footer class='post-footer'>
</footer>
</article>

<article class='post'>
<header class='post-header'>
<a href='/dev-tty-keycaps'><h1 class='post-title'>/dev/tty MT3 Custom Keycap Set</h1></a>
<section class='post-meta'>
<time class='post-date' datetime='2018-05-07'>Monday, May 7, 2018</time>
</section>
</header>
<section class='post-content'>
<p><img src="https://rushfrisby.com/content/images/2018/05/dev_tty.png" alt="/dev/tty MT3 Custom Keycap Set" /></p>

<p>These keycaps are based on the profile from IBM beamspring terminals of the 1970s, this custom set is the first-ever fully sculpted set of dye-sublimated PBT keycaps in Hi-Profile.</p>

<p>Many computer terminals of old were constructed with a slanted switch layout from front to back. Because of that slant the keycaps sat at an angle atop the switches. This set is a reimagination of that unique slanted build, but optimized for modern keyboards. Thanks to significant 3D modeling work from Matt3o the MT3 profile is born!</p>

<p>The built quality of this set is impeccable. The plastic is think and the dye-sublimated are super clean and have a fantastic sound. The lip and cup on the top of the caps contour finger tips perfectly. On top of that the color tone is very pleasing. I got the RGB modifiers which give the set a pop of color.</p>

<p>By far my favorite keycaps ever!</p>
</section>
<footer class='post-footer'>
</footer>
</article>

<article class='post'>
<header class='post-header'>
<a href='/varmilo-va87mr'><h1 class='post-title'>Varmilo VA87MR Keyboard</h1></a>
<section class='post-meta'>
<time class='post-date' datetime='2018-05-07'>Monday, May 7, 2018</time>
</section>
</header>
<section class='post-content'>
<p>The fact that I have 3 of these keyboards should tell you a lot.</p>

<p>I love almost everything about these boards. First of all they are super clean. No nasty branding anywhere. The floating keycaps make it easy to clean and look good. The key caps it comes with are front-printed which gives it a stealthly look. They are made of PBT plastic which is far superior to ABS and feel better too. They also use Cherry stabilizers which in my opinion are much better than Costar (feel + sound). Costar stabilizers are also super annoying to deal with when swapping keycaps whereas Cherry's are very easy. The USB cable can be routed to the left, middle, or right. I always keep it in the middle because symmetry is nice. You can order the case in different colors, have the option of many types of switches, and keycap colors.</p>

<p>The only thing I don't like is that the LEDs aren't RGB. This should be standard on every single board nowadays.</p>

<p>Let me tell you a little bit about each board that I have.</p>

<p><strong>Varmilo VA87MR #1</strong>
<img src="/content/images/2016/04/Varmilo_VA87MR.jpg" alt="Varmilo_VA87MR" />
It has a blue case and white PBT front printed keycaps as seen above. The switches are Gateron Blue with blue LED lights. I call it "my boy blue!" The white keycaps on the blue case have crisp and clean look that I like. The Gateron blues have a light feel and the clicks aren't that loud. The LEDs are bright and shine through the key caps at night so I usually keep them on the lowest level of brightness.</p>

<p><strong>Varmilo VA87MR #2</strong> <br />
<img src="/content/images/2016/04/Varmilo_VA87MR_2.jpg" alt="Varmilo_VA87MR" />
I loved my first Varmilo VA87MR keyboard so much that I ordered another! This time I got it with Gateron Green switches, orange LED lights, a white case, and white key caps. The green switches are heavier which I prefer and I didn't have a tenkeyless board with greens yet. They aren't as crisp as Cherry MX Green but better than blues nonetheless. The all white/orange LED also looks pretty sweet.</p>

<p><strong>Varmilo VA87MR #3</strong> 
<img src="/content/images/2018/05/varmilo_mint.png" alt="Varmilo_VA87MR" />
I got this one with a white case and mint key caps just because mint is wacky color. I've never used it with the mint key caps however. It has white LEDs and Cherry MX White switches. Cherry MX Whites are a smoother version of Cherry MX Greens and have a quieter click. I went with white on white on white because it makes the board great for swapping out and highlighting most key cap sets. I've got the <a href="/dev-tty-keycaps/">/dev/tty set</a> on there now and it looks great.</p>
</section>
<footer class='post-footer'>
</footer>
</article>

<article class='post'>
<header class='post-header'>
<a href='/code-keyboard'><h1 class='post-title'>WASD CODE Keyboard</h1></a>
<section class='post-meta'>
<time class='post-date' datetime='2018-05-06'>Sunday, May 6, 2018</time>
</section>
</header>
<section class='post-content'>
<p><img src="/content/images/2018/05/code_keyboard-1.png" alt="CODE_Green" /></p>

<p>I have three CODE keyboards. Two are full size and the third is tenkeyless. They all have black cases (bought them before white was an option). Two have Cherry MX Green switches and one has Cherry MX Clear switches. I bought the full size board with Green's first. I absolutely loved how the board and switches felt. It made typing <strong>fun</strong> and I cranked out a ton of (real) code on it. It was my first board with switches other than Cherry MX Browns. I was nervous that the clickiness would be too noisy so I ordered it with O-rings. I can't say that I preferred the O-rings though. I'm used to noisy keyboards at this point. The second CODE (tenkeyless) board I have I didn't order with O-rings. Cherry MX Green switches are by far my favorite!</p>

<p>The case has no markings or labeling which I am a fan of. A lot of nice boards have logos plastered on them and I find it to be an eye sore. The LEDs light up the white backplate nicely although I wish they were RGB LEDs instead of white.</p>

<p>My only other issue with the board is that my first one came with what seemed to have been painted keycaps and they started chipping after short use. It mostly started chipping around where the legends were, making them deformed and unreadable. My second and third boards did not have this problem however not as much typing was done on those keycaps.</p>
</section>
<footer class='post-footer'>
</footer>
</article>

<article class='post'>
<header class='post-header'>
<a href='/losing-our-memory'><h1 class='post-title'>Losing Our Memory</h1></a>
<section class='post-meta'>
<time class='post-date' datetime='2017-12-08'>Friday, December 8, 2017</time>
</section>
</header>
<section class='post-content'>
<p>I read <a href="http://www.hanselman.com/blog/WhenDidWeStopCaringAboutMemoryManagement.aspx">this post by Scott Hanselman</a> a while back and agree with him in that memory management in .NET is not a concern for developers. I have not thought directly about any of the items he listed within the last 10 years. I learned low level programming early on but once I moved into higher level languages, memory management became something I thought about less and less. There are three factors that contribute to this: Memory capacity, cost, and management.</p>

<p>Memory capacity took a huge jump in the late 2000s. It became common for run-of-the-mill servers to have 16GB+ of RAM. The amount of memory available now is so excessive that database servers can run entirely in memory. In the unlikely event that memory runs out, the emergence of the cloud and auto-scaling saves us - which brings me to my next point.</p>

<p>Memory costs nothing! It's so cheap that maxing out a server with the most RAM possible is expected. If your server is running in the cloud it's not even worth mentioning "memory". The cost of cloud servers is cheap and auto-scaling means you're only paying for what you need anyways. If you need more memory the cloud will give it to you automatically and for the most part without you even knowing!</p>

<p>The third reason why, and most specifically for .NET developers, is that the garbage collector does a darn good job of memory management. This was one of the original selling features of the framework! Let the GC handle what it was meant to do and let developers solve the problem at hand.</p>

<p>Recently I've thought a lot memory management. That's because my company develops firmware in C on handheld devices with a low amount of memory. Hardware specs aren't something companies change regularly and we have a good sourcing cost for the chips we get. Let's just say that there is no incentive to add more memory so developers have to make-do with what they've got.</p>

<p>I'm not writing C, so I'm not thinking about memory directly, but I'm writing web services that are consumed by these devices. Here are some things I have to keep in mind during development:</p>

<ul>
<li>The serialization format must be compatible and performant on our device.</li>
<li>The data types returned must be platform agnostic.</li>
<li>The data structures must adhere to a strict contract.</li>
<li>The size of each piece of data could be an issue.</li>
<li>The overall size of requests and responses must be as small as possible.</li>
</ul>

<p>If all of these criteria are met then I have a <em>pretty good</em> chance of the device being able to work well with the service.</p>

<p>As far as the technologies I chose, I went with Protobuf for serialization. It's fast and produces small output. It's supported on all of the systems &amp; languages my company is working with. Both the software and firmware teams can utilize .proto definitions as contracts and generate structures/classes from them. Protobuf isn't a silver bullet though. I still need to be mindful of the data I am working with...</p>

<p>For example, before our device can communicate with the service it must obtain a security token (a <code>string</code>). I found bug in the the way the security token was generated, so I fixed it, and pushed a new version of the service out. Suddenly our devices stopped working! What happened?</p>

<p>It turns out that the token, before my fix, was 1000 characters long. The firmware team allocated 1000 characters for that field in their code. When I made my fix the token generated was 1200 characters long. The device was truncating the string and subsequent requests to the service couldn't be validated because the token wasn't correct. I hadn't given one thought to the size of token value because a <code>string</code> type in .NET can hold a variable length (fairly large) string no problem. On our devices though, that 1000 characters was critical!</p>

<p>In conclusion, I don't expect .NET developers will actively pay attention to memory management. They should keep it in the back of their mind at all times though. It's important to know how the framework you are working with deals with memory. It would be a good investment to dig deep into it when beginning to learn a new framework. Once .NET Core becomes more prevalent I expect memory management will garner some attention, but ultimately it will end up in the state that .NET Framework developers are in now - ignorance.</p>
</section>
<footer class='post-footer'>
</footer>
</article>

</div>
<div id="sidebar"><div class="box sidebox about">
<div class="sidebox-title">About</div>
<div class="sidebox-content">
<p class="center"><img src="/img/rush_headshot_2018_256-min.jpg" title="Rush Frisby" alt="Rush Frisby" width="256" height="256" /></p>
<p>Rush is a software architect who loves solving problems. You'll usually find him writing about security concepts and sharing solutions to problems he's faced.</p>
</div>
</div>
<div class="sidebox box social clearfix">
<ul>
<a href="/rss" target="_blank" class="social-item rss"><li><i class="fa fa-rss"></i></li></a>
<a href="https://twitter.com/rushonerok" target="_blank" class="social-item tw"><li><i class="fa fa-twitter"></i></li></a>
<a href="http://github.com/rushfrisby" class="social-item github"><li><i class="fa fa-github"></i></li></a>
<a href="/" class="social-item home"><li><i class="fa fa-home"></i></li></a>
</ul>
</div>
</main>
<footer class="site-footer clearfix">
<section class="copyright"><a href="https://rushfrisby.com">Rush Frisby</a> &copy; 2018</section>
<section class="poweredby">Proudly published with my own blog engine</section>
</footer>
<script type="text/javascript">
var links = document.links;
for (var i = 0, linksLength = links.length; i < linksLength; i++) {
   if (links[i].hostname != window.location.hostname) {
       links[i].target = '_blank';
   } 
}
</script>
<script type="text/javascript" src="/js/jquery.min.js?v=800fecc11f"></script>
<script type="text/javascript" src="/js/jquery.fitvids.js?v=800fecc11f"></script>
<script type="text/javascript" src="/js/jquery.xml2json.js?v=800fecc11f"></script>
<script type="text/javascript" src="/js/index.js?v=800fecc11f"></script>
<script type="text/javascript" src="/js/webkid.js?v=800fecc11f"></script>
</body>
</html>
